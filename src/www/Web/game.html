<!doctype html>

<html>
<head>
    <meta charset="utf-8">
    <title>测试</title>

    <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0; minimum-scale=1.0; user-scalable=0;" />
    <meta name="apple-mobile-web-app-capable" content="YES">
    <!--<meta name="apple-mobile-web-app-status-bar-style" content="black">-->
    <meta name="title" content="测试" />
    <meta name="description" content="测试" />
</head>

<body>
<button id="enterRoom">进入房间</button>
<button id="roomList">房间列表</button>
<button id="exitRoom">退出房间</button>
<button id="startGame" style="display: none">开始游戏</button>
<div id="chatFrame">

</div>
<script src="/js/jquery.min.js" ></script>
<script>
    let ws = new WebSocket("ws://10.64.56.79:9997");


    ws.onopen = function(evt) {
        console.log("Connection open ...");

    };

    ws.onmessage = function(evt) {
        console.log(evt);
        let evtData = JSON.parse(evt.data);
        //逻辑处理。。
        //1001 进入房间
        console.log('evtData',evtData);
        switch (evtData.type){
            case '1001':
                fMsg(evtData.msg);
                //已进入房间
                $("#startGame").show();
                break;
            case '1004':
                //1004 退出房间
                fMsg(evtData.msg);
                $("#startGame").hide();
                break;
            case '1002':
                evtData.msg = '<div style="color:#66FFCC">'+evtData.msg+'</div>';
                fMsg(evtData.msg);
                break;
            case '1003':
            case '2001':
            case '2002':
                evtData.msg = '<div style="color:#238E23">'+evtData.msg+'</div>';
                fMsg(evtData.msg);
                console.log('evtData.params',evtData.params);
                fMsg('<div style="color:#238E23">'+JSON.stringify(evtData.params)+'</div>');
            break;
            default:
                fMsg(evtData.msg);
        }

    };

    ws.onclose = function(evt) {
        console.log("Connection closed.");
    };

    function fMsg(msg) {
        $("#chatFrame").append(msg+'<br />');
    }

    $("#enterRoom").click(function () {
       ws.send(JSON.stringify({'type':'enterRoom'}));
    });

    $("#roomList").click(function () {
        ws.send(JSON.stringify({'type':'roomList'}));
    });

    $("#exitRoom").click(function () {
        ws.send(JSON.stringify({'type':'exitRoom'}));
    });
    $("#startGame").click(function () {
        ws.send(JSON.stringify({'type':'startGame'}));
    });
</script>
</body>
</html>